{"version":3,"sources":["Piece.js","Board.js","Chess.js","serviceWorker.js","index.js"],"names":["Piece","hasMoved","isPromoted","this","color","type","charAt","toUpperCase","new","p","Board","rows","items","pieceAt","field","possibleMoves","piece","from","allFields","filter","to","isValidMove","hasPossibleMove","some","hasAnyPossibleMoves","position","fieldDescription","String","fromCharCode","toString","move","isValid","pieceAtDestination","oldSymbol","symbol","otherPlayerColor","kingPosition","findKing","isUnderAttack","replace","find","f","fields","i","j","push","canMove","v","h","dh","Math","abs","dv","canRookMove","idx","dir","canBishopMove","vMulti","hMulti","canKnightMove","adv","b","king","initialRow","pawnRow","Array","keys","map","initialState","board","_","JSON","parse","stringify","Chess","props","onFieldSelected","setState","prevState","selectedField","state","currentColor","status","isSuccess","includes","pieceStyle","isPossibleMove","styles","selected","possible","cellStyle","cell1","cell2","View","style","container","row","key","e","TouchableOpacity","onPress","activeOpacity","Text","text","backgroundColor","width","textAlign","marginTop","React","Component","StyleSheet","create","flex","height","marginHorizontal","flexDirection","fontSize","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.fc9fa785.chunk.js","sourcesContent":["type PieceType = 'king' | 'queen' | 'rook' | 'bishop' | 'knight' | 'pawn';\nexport type ColorType = 'white' | 'black';\n\nexport default class Piece {\n  type: PieceType;\n  color: ColorType;\n  hasMoved = false;\n  isPromoted = false;\n\n  static new = (color: ColorType, type: PieceType): Piece => {\n    const p = new Piece();\n    p.color = color;\n    p.type = type;\n\n    return p;\n  };\n\n  get text(): string {\n    switch (this.color) {\n      case 'white':\n        switch (this.type) {\n          case 'king':\n            return '♔';\n          case 'queen':\n            return '♕';\n          case 'rook':\n            return '♖';\n          case 'bishop':\n            return '♗';\n          case 'knight':\n            return '♘';\n          case 'pawn':\n            return '♙';\n        }\n        break;\n      case 'black':\n        switch (this.type) {\n          case 'king':\n            return '♚';\n          case 'queen':\n            return '♛';\n          case 'rook':\n            return '♜';\n          case 'bishop':\n            return '♝';\n          case 'knight':\n            return '♞';\n          case 'pawn':\n            return '♟';\n        }\n    }\n  }\n\n  get symbol(): string {\n    if (this.type === 'pawn') {\n      return '';\n    } else {\n      return this.type.charAt(0).toUpperCase();\n    }\n  }\n}\n","import Piece from './Piece';\nimport type {ColorType} from './Piece';\n\ntype BoardRow = Array<?Piece>;\n\ntype Field = [number, number];\n\nconst deepClone = (items) => JSON.parse(JSON.stringify(items));\n\nexport default class Board {\n  rows: Array<BoardRow>;\n\n  constructor(rows?: Array<BoardRow>) {\n    this.rows = rows ? deepClone(rows) : this.initialState();\n  }\n\n  pieceAt = (field: Field): ?Piece => {\n    return this.rows[field[0]][field[1]];\n  };\n\n  possibleMoves = (piece: Piece, from: Field): [?Field] => {\n    return this.allFields().filter((to) => this.isValidMove(piece, from, to));\n  };\n\n  hasPossibleMove = (piece: Piece, from: Field): boolean => {\n    return this.allFields().some((to) => this.isValidMove(piece, from, to));\n  };\n\n  hasAnyPossibleMoves = (color: ColorType): boolean => {\n    return !this.allFields().some((position) => {\n      const piece = this.pieceAt(position);\n      if (!piece || piece.color !== color) {\n        return false;\n      }\n      return this.hasPossibleMove(piece, position);\n    });\n  };\n\n  fieldDescription = (field: Field): string => {\n    return String.fromCharCode(97 + field[1]) + (8 - field[0]).toString();\n  };\n\n  move = (from: Field, to: Field, isValid?: boolean): ?string => {\n    const piece = this.pieceAt(from);\n\n    if (piece && (isValid ?? this.isValidMove(piece, from, to))) {\n      const pieceAtDestination = this.pieceAt(to);\n\n      if (\n        pieceAtDestination != null &&\n        pieceAtDestination.color === piece.color\n      ) {\n        return null;\n      } else {\n        piece.hasMoved = true;\n        this.rows[to[0]][to[1]] = piece;\n        this.rows[from[0]][from[1]] = null;\n\n        if (piece.type === 'pawn' && (to[0] === 0 || to[0] === 7)) {\n          const oldSymbol = piece.symbol;\n          piece.type = 'queen';\n          piece.isPromoted = true;\n          return oldSymbol + this.fieldDescription(from) + '=' + piece.symbol;\n        }\n\n        const move =\n          piece.symbol +\n          this.fieldDescription(from) +\n          '-' +\n          this.fieldDescription(to);\n\n        const otherPlayerColor = piece.color === 'white' ? 'black' : 'white';\n        const kingPosition = this.findKing(otherPlayerColor);\n        if (isValid !== true) {\n          const hasAnyPossibleMoves = this.hasAnyPossibleMoves(\n            otherPlayerColor,\n          );\n\n          if (this.isUnderAttack(kingPosition, otherPlayerColor)) {\n            if (hasAnyPossibleMoves) {\n              return move + 'X';\n            } else {\n              return move + '+';\n            }\n          } else if (hasAnyPossibleMoves) {\n            return move + '=';\n          }\n        }\n\n        return pieceAtDestination ? move.replace('-', ':') : move;\n      }\n    } else {\n      return null;\n    }\n  };\n\n  findKing = (color: ColorType): Field => {\n    return this.allFields().find((f) => {\n      const piece = this.pieceAt(f);\n      return piece?.type === 'king' && piece?.color === color;\n    });\n  };\n\n  allFields = (): [Field] => {\n    const fields = [];\n    for (let i = 0; i < 8; i++) {\n      for (let j = 0; j < 8; j++) {\n        fields.push([i, j]);\n      }\n    }\n    return fields;\n  };\n\n  isUnderAttack = (field: Field, color: ColorType): boolean => {\n    const checker = this.allFields().find((position) => {\n      const piece = this.pieceAt(position);\n      if (!piece || piece.color === color) {\n        return false;\n      }\n      return this.isValidMove(piece, position, field);\n    });\n\n    return checker != null;\n  };\n\n  canMove = (piece: Piece, from: Field, to: Field): boolean => {\n    const v = from[0] - to[0];\n    const h = from[1] - to[1];\n    const dh = Math.abs(h);\n    const dv = Math.abs(v);\n\n    const canRookMove = () => {\n      if (dh !== 0 && dv !== 0) {\n        return false;\n      }\n\n      const idx = dv > 0 ? 0 : 1;\n      const dir = (idx ? h : v) > 0 ? 1 : -1;\n      for (let i = from[idx] - dir; (i - to[idx]) * dir > 0; i -= dir) {\n        const field = dv > 0 ? [i, from[1]] : [from[0], i];\n        if (this.pieceAt(field)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    const canBishopMove = () => {\n      if (dh !== dv) {\n        return false;\n      }\n\n      const vMulti = v < 0 ? 1 : -1;\n      const hMulti = h < 0 ? 1 : -1;\n\n      for (let i = 1; i < dv; i++) {\n        const field = [from[0] + i * vMulti, from[1] + i * hMulti];\n        if (this.pieceAt(field)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    const canKnightMove = () => {\n      return (dh === 2 && dv === 1) || (dh === 1 && dv === 2);\n    };\n\n    switch (piece.type) {\n      case 'king':\n        return dh <= 1 && dv <= 1 && !this.isUnderAttack(to, piece.color);\n      case 'queen':\n        return (\n          canRookMove() ||\n          canBishopMove() ||\n          (piece.isPromoted && canKnightMove())\n        );\n      case 'rook':\n        return canRookMove();\n      case 'bishop':\n        return canBishopMove();\n      case 'knight':\n        return canKnightMove();\n      case 'pawn':\n        const dir = piece.color === 'white' ? 1 : -1;\n        const adv = v * dir;\n        if (dh === 1 && adv === 1) {\n          return this.pieceAt(to) != null;\n        }\n\n        if (dh > 0) {\n          return false;\n        }\n\n        if (adv === 2 && !piece.hasMoved) {\n          if (this.pieceAt([from[0] - dir, from[1]])) {\n            return false;\n          }\n        } else if (adv !== 1) {\n          return false;\n        }\n        return this.pieceAt(to) == null;\n      default:\n        return false;\n    }\n  };\n\n  isValidMove = (piece: Piece, from: Field, to: Field): boolean => {\n    if (!to) {\n      return false;\n    }\n\n    if (this.pieceAt(to)?.color === piece.color) {\n      return false;\n    }\n\n    if (!this.canMove(piece, from, to)) {\n      return false;\n    }\n\n    const b = new Board(this.rows);\n    b.move(from, to, true);\n    const king = b.findKing(piece.color);\n    if (!king) {\n      return true;\n    }\n\n    return !b.isUnderAttack(king, piece.color);\n  };\n\n  initialRow = (color: ColorType): BoardRow => {\n    return [\n      Piece.new(color, 'rook'),\n      Piece.new(color, 'knight'),\n      Piece.new(color, 'bishop'),\n      Piece.new(color, 'queen'),\n      Piece.new(color, 'king'),\n      Piece.new(color, 'bishop'),\n      Piece.new(color, 'knight'),\n      Piece.new(color, 'rook'),\n    ];\n  };\n\n  pawnRow = (color: ColorType): BoardRow => {\n    return [...Array(8).keys()].map((i) => Piece.new(color, 'pawn'));\n  };\n\n  initialState = (): Array<BoardRow> => {\n    const board = [...Array(8).keys()].map(() =>\n      [...Array(8).keys()].map((_) => null),\n    );\n\n    board[0] = this.initialRow('black');\n    board[1] = this.pawnRow('black');\n    board[6] = this.pawnRow('white');\n    board[7] = this.initialRow('white');\n\n    return board;\n  };\n}\n","import React from 'react';\nimport {View, Text, StyleSheet, TouchableOpacity} from 'react-native';\nimport Board from './Board';\nimport type {ColorType} from './Piece';\nimport type {MoveResult} from './Board';\n\ntype AppState = {\n  currentColor: ColorType,\n  selectedField: ?[number, number],\n  status: ?MoveResult,\n};\n\nexport default class Chess extends React.Component<{}, AppState> {\n  board: Board = new Board();\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentColor: 'white',\n      selectedField: null,\n      status: null,\n    };\n  }\n\n  onFieldSelected = (field: [number, number]) => {\n    this.setState((prevState: AppState) => {\n      if (!prevState.selectedField) {\n        if (\n          this.board.pieceAt(field) &&\n          this.board.pieceAt(field)?.color !== this.state.currentColor\n        ) {\n          return {\n            selectedField: prevState.selectedField,\n          };\n        }\n\n        return {\n          selectedField: this.board.pieceAt(field) ? field : null,\n        };\n      }\n\n      if (!this.board.pieceAt(prevState.selectedField)) {\n        return {\n          selectedField: field,\n        };\n      }\n\n      const status = this.board.move(prevState.selectedField, field);\n\n      const isSuccess = [\n        'move',\n        'captured',\n        'promotion',\n        'check',\n        'checkmate',\n      ].includes(status);\n      const nextField = isSuccess\n        ? null\n        : status === 'own'\n        ? field\n        : prevState.selectedField;\n\n      const nextColor = isSuccess\n        ? prevState.currentColor === 'white'\n          ? 'black'\n          : 'white'\n        : prevState.currentColor;\n\n      return {\n        selectedField: nextField,\n        currentColor: nextColor,\n        status: status,\n      };\n    });\n  };\n\n  pieceStyle = (field: [number, number]): any => {\n    const [i, j] = field;\n    let isPossibleMove = false;\n    if (this.state.selectedField != null) {\n      const piece = this.board.pieceAt(this.state.selectedField);\n      if (piece != null) {\n        isPossibleMove = this.board.isValidMove(\n          piece,\n          this.state.selectedField,\n          field,\n        );\n      }\n    }\n\n    return [\n      styles.piece,\n      this.state.selectedField &&\n      i === this.state.selectedField[0] &&\n      j === this.state.selectedField[1]\n        ? styles.selected\n        : null,\n      isPossibleMove ? styles.possible : null,\n    ];\n  };\n\n  cellStyle = (field: [number, number]): any => {\n    return [(field[0] + field[1]) % 2 === 0 ? styles.cell1 : styles.cell2];\n  };\n\n  render() {\n    return (\n      <View style={styles.container}>\n        {this.board.rows.map((row, i) => {\n          return (\n            <View key={i} style={styles.row}>\n              {row.map((e, j) => (\n                <TouchableOpacity\n                  key={j}\n                  onPress={() => this.onFieldSelected([i, j])}\n                  style={this.cellStyle([i, j])}\n                  activeOpacity={1}>\n                  <Text style={this.pieceStyle([i, j])}>{e?.text ?? ''}</Text>\n                </TouchableOpacity>\n              ))}\n            </View>\n          );\n        })}\n        <Text>Current move: {this.state.currentColor}</Text>\n        <Text>{this.state.status ?? '-'}</Text>\n        <Text\n          style={{\n            backgroundColor: 'orange',\n            width: 50,\n            textAlign: 'center',\n            marginTop: 8,\n          }}\n          onPress={() => {\n            this.board.rows = this.board.initialState();\n            this.setState({\n              selectedField: null,\n              currentColor: 'white',\n              status: null,\n            });\n          }}>\n          Reset\n        </Text>\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: 400,\n    height: 400,\n    backgroundColor: 'white',\n    marginHorizontal: 'auto',\n    marginTop: 60,\n  },\n  row: {\n    flexDirection: 'row',\n  },\n  piece: {\n    textAlign: 'center',\n    fontSize: 30,\n    width: 50,\n    height: 50,\n  },\n  cell1: {\n    width: 50,\n    height: 50,\n    backgroundColor: 'rgba(0, 0, 0, 0.1)',\n  },\n  cell2: {\n    width: 50,\n    height: 50,\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  selected: {\n    backgroundColor: 'rgba(255, 255, 0, 1)',\n  },\n\n  possible: {\n    backgroundColor: 'rgba(0, 255, 0, 0.5)',\n  },\n});\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./Chess\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}